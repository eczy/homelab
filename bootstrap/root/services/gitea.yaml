apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: gitea
  namespace: argocd
  finalizers:
  - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  source:
    chart: gitea
    repoURL: https://dl.gitea.io/charts/
    targetRevision: 6.0.3
    helm:
      releaseName: gitea
      parameters:
      - name: "initPreScript"
        value: "gitea cert --host gitea.home.lan"
      - name: "postgresql.livenessProbe.initialDelaySeconds"
        value: "300"
      - name: "gitea.config.server.ROOT_URL"
        value: "https://gitea.home.lan"
      - name: "service.ssh.type"
        value: "LoadBalancer"
      - name: "service.ssh.annotations.metallb\\.universe\\.tf/allow-shared-ip"
        value: "gitea"
      - name: "service.ssh.loadBalancerIP"
        value: "192.168.50.201"
      - name: "service.ssh.externalTrafficPolicy"
        value: "Local"
      - name: "service.http.type"
        value: "LoadBalancer"
      - name: "service.http.annotations.metallb\\.universe\\.tf/allow-shared-ip"
        value: "gitea"
      - name: "service.http.externalTrafficPolicy"
        value: "Local"
      - name: "service.http.loadBalancerIP"
        value: "192.168.50.201"
      - name: "gitea.config.server.PROTOCOL"
        value: "https"
      - name: "gitea.config.server.HTTP_PORT"
        value: "443"
      - name: "gitea.config.server.CERT_FILE"
        value: "/cert.pem"
      - name: "gitea.config.server.KEY_FILE"
        value: "/key.pem"
      - name: "gitea.config.server.ROOT_URL"
        value: "https://gitea.home.lan"
      - name: "gitea.server.REDIRECT_OTHER_PORT"
        value: "true"
      - name: "gitea.server.PORT_TO_REDIRECT"
        value: "80"
  destination:
    server: https://kubernetes.default.svc
    namespace: gitea